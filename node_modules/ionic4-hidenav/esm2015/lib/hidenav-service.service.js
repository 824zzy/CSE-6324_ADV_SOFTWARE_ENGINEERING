/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import { Injectable } from '@angular/core';
import * as i0 from "@angular/core";
export class HidenavService {
    constructor() {
        this.data = [];
        this.names = [];
        this.tabnames = [];
    }
    /**
     * @return {?}
     */
    requestName() {
        /** @type {?} */
        let name = 'page' + this.names.length;
        this.names.push(name);
        return name;
    }
    /**
     * @param {?} name
     * @return {?}
     */
    requestTabName(name) {
        if (!this.tabnames[name])
            this.tabnames[name] = [];
        /** @type {?} */
        let tabname = name + 'tab' + this.tabnames[name].length;
        this.tabnames[name].push(tabname);
        return tabname;
    }
    /**
     * @param {?} name
     * @return {?}
     */
    initiate(name) {
        /** @type {?} */
        let names = [];
        for (let key in this.data) {
            if (this.data[key].parent == name)
                names.push(key);
        }
        for (let name of names) {
            this.initiate2(name);
        }
        if (names.length == 0)
            this.initiate2(name);
    }
    /**
     * @param {?} name
     * @return {?}
     */
    initiate2(name) {
        if (!(this.data[name] && (this.data[name].parent && this.data[this.data[name].parent].tabscontent && this.data[name].content && this.data[this.data[name].parent].header) || (!this.data[name].parent && this.data[name].content && this.data[name].header)))
            return false;
        /** @type {?} */
        let parent = this.data[name].parent;
        /** @type {?} */
        let content = this.data[name].content;
        /** @type {?} */
        let contentElem = this.data[name].contentElem;
        if (this.data[name].scrollTop == null)
            this.data[name].scrollTop = 0;
        if (this.data[name].lastscroll == null)
            this.data[name].lastscroll = 0;
        if (this.data[name].direction == null)
            this.data[name].direction = '';
        if (this.data[name].tapping == null)
            this.data[name].tapping = false;
        content.scrollEvents = true;
        if (!parent) {
            /** @type {?} */
            let header = this.data[name].header;
            setTimeout((/**
             * @return {?}
             */
            () => {
                this.data[name].navheight = this.data[name].header.nativeElement.offsetHeight;
                /** @type {?} */
                let scrollContent = contentElem.nativeElement.shadowRoot.querySelector('.inner-scroll');
                this.data[name].paddingTop = parseInt(window.getComputedStyle(scrollContent)['padding-top'], 10);
                content.ionScroll.subscribe((/**
                 * @param {?} e
                 * @return {?}
                 */
                (e) => {
                    if (e.detail.scrollTop == 0) {
                        scrollContent.style.top = null;
                        scrollContent.style.paddingTop = this.data[name].paddingTop + 'px';
                    }
                    else {
                        scrollContent.style.top = '-' + this.data[name].navheight + 'px';
                        scrollContent.style.paddingTop = this.data[name].paddingTop + this.data[name].navheight + 'px';
                    }
                    if (scrollContent.scrollHeight > (scrollContent.clientHeight + 100)) {
                        this.data[name].scrolling = true;
                        /** @type {?} */
                        let x = this.data[name].lastscroll - e.detail.scrollTop;
                        this.data[name].direction = x > 0 ? 'up' : 'down';
                        this.data[name].lastscroll = e.detail.scrollTop;
                        this.data[name].scrollTop = this.data[name].scrollTop - x;
                        if (this.data[name].scrollTop > this.data[name].navheight)
                            this.data[name].scrollTop = this.data[name].navheight;
                        if (this.data[name].scrollTop < 0)
                            this.data[name].scrollTop = 0;
                        header.nativeElement.style.transform = 'translate3d(0, ' + -this.data[name].scrollTop + 'px, 0)';
                    }
                }));
                content.ionScrollEnd.subscribe((/**
                 * @return {?}
                 */
                () => {
                    setTimeout((/**
                     * @return {?}
                     */
                    () => {
                        //catch the last tick
                        if (scrollContent.scrollTop == 0) {
                            scrollContent.style.top = null;
                            scrollContent.style.paddingTop = this.data[name].paddingTop + 'px';
                        }
                        this.data[name].scrolling = false;
                        this.c(name);
                    }), 10);
                }));
            }), 100);
            contentElem.nativeElement.addEventListener('touchend', (/**
             * @return {?}
             */
            () => {
                this.data[name].tapping = false;
                this.c(name);
            }));
            contentElem.nativeElement.addEventListener('touchstart', (/**
             * @return {?}
             */
            () => this.data[name].tapping = true));
        }
        else if (parent) {
            /** @type {?} */
            let header = this.data[parent].header;
            /** @type {?} */
            let tabscontentElem = this.data[parent].tabscontentElem;
            /** @type {?} */
            let supertabsToolbar = tabscontentElem.nativeElement.querySelector('super-tabs-toolbar');
            setTimeout((/**
             * @return {?}
             */
            () => {
                this.data[parent].tabscontentHeight = tabscontentElem.nativeElement.scrollHeight;
                /** @type {?} */
                let scrollContent = contentElem.nativeElement.shadowRoot.querySelector('.inner-scroll');
                /** @type {?} */
                let tabsscrollContent = this.data[parent].tabscontentElem.nativeElement.shadowRoot.querySelector('.inner-scroll');
                if (scrollContent.scrollHeight > (scrollContent.clientHeight + 100)) {
                    this.data[name].navheight = this.data[parent].header.nativeElement.offsetHeight;
                    this.data[name].paddingTop = parseInt(window.getComputedStyle(scrollContent)['padding-top'], 10);
                }
                content.ionScroll.subscribe((/**
                 * @param {?} e
                 * @return {?}
                 */
                (e) => {
                    if (this.data[name].tapping && scrollContent.scrollHeight > (scrollContent.clientHeight + 100)) {
                        if (e.detail.scrollTop == 0) {
                            supertabsToolbar.style.position = 'static';
                            scrollContent.style.paddingTop = this.data[name].paddingTop + 'px';
                            tabscontentElem.nativeElement.style.top = null;
                            tabsscrollContent.style.height = this.data[parent].tabscontentHeight + 'px';
                            tabscontentElem.nativeElement.style.top = null;
                        }
                        else {
                            /** @type {?} */
                            let s = e.detail.scrollTop;
                            supertabsToolbar.style.position = 'absolute';
                            supertabsToolbar.style.top = this.data[name].navheight + 'px';
                            tabsscrollContent.style.height = (this.data[parent].tabscontentHeight + this.data[name].navheight) + 'px';
                            tabscontentElem.nativeElement.style.top = '-' + this.data[name].navheight + 'px';
                            scrollContent.style.paddingTop = this.data[name].paddingTop + supertabsToolbar.clientHeight + this.data[name].navheight + 'px';
                            scrollContent.scrollTop = s;
                        }
                    }
                    this.data[name].scrolling = true;
                    /** @type {?} */
                    let x = this.data[name].lastscroll - e.detail.scrollTop;
                    this.data[name].direction = x > 0 ? 'up' : 'down';
                    this.data[name].lastscroll = e.detail.scrollTop;
                    this.data[name].scrollTop = this.data[name].scrollTop - x;
                    if (this.data[name].scrollTop > this.data[name].navheight)
                        this.data[name].scrollTop = this.data[name].navheight;
                    if (this.data[name].scrollTop < 0)
                        this.data[name].scrollTop = 0;
                    header.nativeElement.style.transform = 'translate3d(0, ' + -this.data[name].scrollTop + 'px, 0)';
                    supertabsToolbar.style.transform = 'translate3d(0, ' + -this.data[name].scrollTop + 'px, 0)';
                }));
                content.ionScrollEnd.subscribe((/**
                 * @return {?}
                 */
                () => {
                    setTimeout((/**
                     * @return {?}
                     */
                    () => {
                        //catch the last tick
                        if (scrollContent.scrollTop == 0) {
                            supertabsToolbar.style.position = 'static';
                            scrollContent.style.paddingTop = this.data[name].paddingTop + 'px';
                            tabscontentElem.nativeElement.style.top = null;
                            tabsscrollContent.style.height = this.data[parent].tabscontentHeight + 'px';
                            tabscontentElem.nativeElement.style.top = null;
                        }
                        this.data[name].scrolling = false;
                        this.c(name);
                    }), 10);
                }));
            }), 100);
            contentElem.nativeElement.addEventListener('touchend', (/**
             * @return {?}
             */
            () => {
                this.data[name].tapping = false;
                this.c(name);
            }));
            contentElem.nativeElement.addEventListener('touchstart', (/**
             * @return {?}
             */
            () => this.data[name].tapping = true));
        }
    }
    /**
     * @private
     * @param {?} name
     * @return {?}
     */
    c(name) {
        if (this.data[name].tapping || this.data[name].scrolling)
            return false;
        if (this.data[name].scrollTop == 0 || this.data[name].scrollTop == this.data[name].navheight)
            return false;
        /** @type {?} */
        let content = this.data[name].content;
        /** @type {?} */
        let scrollTopTemp = this.data[name].scrollTop;
        if (this.data[name].direction == 'down') {
            if (this.data[name].scrollTop < this.data[name].navheight) {
                content.scrollByPoint(0, (this.data[name].navheight - scrollTopTemp), (this.data[name].navheight - scrollTopTemp) * 6);
            }
        }
        else if (this.data[name].direction == 'up') {
            if (this.data[name].scrollTop < this.data[name].navheight) {
                content.scrollByPoint(0, -scrollTopTemp, scrollTopTemp * 6);
            }
        }
    }
    /**
     * @param {?} parent
     * @param {?} name
     * @return {?}
     */
    resetTabs(parent, name) {
        /** @type {?} */
        let header = this.data[parent].header;
        /** @type {?} */
        let tabscontentElem = this.data[parent].tabscontentElem;
        /** @type {?} */
        let supertabsToolbar = tabscontentElem.nativeElement.querySelector('super-tabs-toolbar');
        /** @type {?} */
        let tabsscrollContent = this.data[parent].tabscontentElem.nativeElement.shadowRoot.querySelector('.inner-scroll');
        /** @type {?} */
        let scrollContent = this.data[name].contentElem.nativeElement.shadowRoot.querySelector('.inner-scroll');
        scrollContent.scrollTop = scrollContent.scrollTop - this.data[name].scrollTop;
        setTimeout((/**
         * @return {?}
         */
        () => {
            if (scrollContent.scrollTop == 0) {
                supertabsToolbar.style.position = 'static';
                scrollContent.style.paddingTop = this.data[name].paddingTop + 'px';
                tabscontentElem.nativeElement.style.top = null;
                tabsscrollContent.style.height = this.data[parent].tabscontentHeight + 'px';
                tabscontentElem.nativeElement.style.top = null;
            }
            else {
                /** @type {?} */
                let s = scrollContent.scrollTop;
                supertabsToolbar.style.position = 'absolute';
                supertabsToolbar.style.top = this.data[name].navheight + 'px';
                tabsscrollContent.style.height = (this.data[parent].tabscontentHeight + this.data[name].navheight) + 'px';
                tabscontentElem.nativeElement.style.top = '-' + this.data[name].navheight + 'px';
                scrollContent.style.paddingTop = this.data[name].paddingTop + supertabsToolbar.clientHeight + this.data[name].navheight + 'px';
                scrollContent.scrollTop = s;
            }
            header.nativeElement.style.transform = null;
            supertabsToolbar.style.transform = null;
        }), 20);
    }
}
HidenavService.decorators = [
    { type: Injectable, args: [{
                providedIn: 'root'
            },] }
];
HidenavService.ctorParameters = () => [];
/** @nocollapse */ HidenavService.ngInjectableDef = i0.defineInjectable({ factory: function HidenavService_Factory() { return new HidenavService(); }, token: HidenavService, providedIn: "root" });
if (false) {
    /** @type {?} */
    HidenavService.prototype.data;
    /** @type {?} */
    HidenavService.prototype.names;
    /** @type {?} */
    HidenavService.prototype.tabnames;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaGlkZW5hdi1zZXJ2aWNlLnNlcnZpY2UuanMiLCJzb3VyY2VSb290Ijoibmc6Ly9pb25pYzQtaGlkZW5hdi8iLCJzb3VyY2VzIjpbImxpYi9oaWRlbmF2LXNlcnZpY2Uuc2VydmljZS50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7O0FBQUEsT0FBTyxFQUFDLFVBQVUsRUFBQyxNQUFNLGVBQWUsQ0FBQzs7QUFLekMsTUFBTTtJQU1GO1FBSkEsU0FBSSxHQUFHLEVBQUUsQ0FBQztRQUNWLFVBQUssR0FBRyxFQUFFLENBQUM7UUFDWCxhQUFRLEdBQUcsRUFBRSxDQUFDO0lBR2QsQ0FBQzs7OztJQUVELFdBQVc7O1lBQ0gsSUFBSSxHQUFHLE1BQU0sR0FBQyxJQUFJLENBQUMsS0FBSyxDQUFDLE1BQU07UUFDbkMsSUFBSSxDQUFDLEtBQUssQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLENBQUM7UUFDdEIsT0FBTyxJQUFJLENBQUM7SUFDaEIsQ0FBQzs7Ozs7SUFFRCxjQUFjLENBQUMsSUFBSTtRQUNmLElBQUcsQ0FBQyxJQUFJLENBQUMsUUFBUSxDQUFDLElBQUksQ0FBQztZQUNuQixJQUFJLENBQUMsUUFBUSxDQUFDLElBQUksQ0FBQyxHQUFHLEVBQUUsQ0FBQzs7WUFDekIsT0FBTyxHQUFHLElBQUksR0FBQyxLQUFLLEdBQUMsSUFBSSxDQUFDLFFBQVEsQ0FBQyxJQUFJLENBQUMsQ0FBQyxNQUFNO1FBQ25ELElBQUksQ0FBQyxRQUFRLENBQUMsSUFBSSxDQUFDLENBQUMsSUFBSSxDQUFDLE9BQU8sQ0FBQyxDQUFDO1FBQ2xDLE9BQU8sT0FBTyxDQUFDO0lBQ25CLENBQUM7Ozs7O0lBRUQsUUFBUSxDQUFDLElBQUk7O1lBQ0wsS0FBSyxHQUFHLEVBQUU7UUFDZCxLQUFLLElBQUksR0FBRyxJQUFJLElBQUksQ0FBQyxJQUFJLEVBQUU7WUFDdkIsSUFBSSxJQUFJLENBQUMsSUFBSSxDQUFDLEdBQUcsQ0FBQyxDQUFDLE1BQU0sSUFBSSxJQUFJO2dCQUM3QixL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QUcsQ0FBQyxDQUFDO2FBQy9CO1lBQ0QsTUFBTSxDQUFDLGFBQWEsQ0FBQyxLQUFLLENBQUMsU0FBUyxHQUFHLElBQUksQ0FBQztZQUM1QyxnQkFBZ0IsQ0FBQyxLQUFLLENBQUMsU0FBUyxHQUFHLElBQUksQ0FBQztRQUM1QyxDQUFDLEdBQUUsRUFBRSxDQUFDLENBQUM7SUFFWCxDQUFDOzs7WUFoTkosVUFBVSxTQUFDO2dCQUNSLFVBQVUsRUFBRSxNQUFNO2FBQ3JCOzs7Ozs7SUFHRyw4QkFBVTs7SUFDViwrQkFBVzs7SUFDWCxrQ0FBYyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7SW5qZWN0YWJsZX0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XHJcblxyXG5ASW5qZWN0YWJsZSh7XHJcbiAgICBwcm92aWRlZEluOiAncm9vdCdcclxufSlcclxuZXhwb3J0IGNsYXNzIEhpZGVuYXZTZXJ2aWNlIHtcclxuXHJcbiAgICBkYXRhID0gW107XHJcbiAgICBuYW1lcyA9IFtdO1xyXG4gICAgdGFibmFtZXMgPSBbXTtcclxuXHJcbiAgICBjb25zdHJ1Y3RvcigpIHtcclxuICAgIH1cclxuXHJcbiAgICByZXF1ZXN0TmFtZSgpe1xyXG4gICAgICAgIGxldCBuYW1lID0gJ3BhZ2UnK3RoaXMubmFtZXMubGVuZ3RoO1xyXG4gICAgICAgIHRoaXMubmFtZXMucHVzaChuYW1lKTtcclxuICAgICAgICByZXR1cm4gbmFtZTtcclxuICAgIH1cclxuXHJcbiAgICByZXF1ZXN0VGFiTmFtZShuYW1lKXtcclxuICAgICAgICBpZighdGhpcy50YWJuYW1lc1tuYW1lXSlcclxuICAgICAgICAgICAgdGhpcy50YWJuYW1lc1tuYW1lXSA9IFtdO1xyXG4gICAgICAgIGxldCB0YWJuYW1lID0gbmFtZSsndGFiJyt0aGlzLnRhYm5hbWVzW25hbWVdLmxlbmd0aDtcclxuICAgICAgICB0aGlzLnRhYm5hbWVzW25hbWVdLnB1c2godGFibmFtZSk7XHJcbiAgICAgICAgcmV0dXJuIHRhYm5hbWU7XHJcbiAgICB9XHJcblxyXG4gICAgaW5pdGlhdGUobmFtZSkge1xyXG4gICAgICAgIGxldCBuYW1lcyA9IFtdO1xyXG4gICAgICAgIGZvciAobGV0IGtleSBpbiB0aGlzLmRhdGEpIHtcclxuICAgICAgICAgICAgaWYgKHRoaXMuZGF0YVtrZXldLnBhcmVudCA9PSBuYW1lKVxyXG4gICAgICAgICAgICAgICAgbmFtZXMucHVzaChrZXkpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBmb3IgKGxldCBuYW1lIG9mIG5hbWVzKSB7XHJcbiAgICAgICAgICAgIHRoaXMuaW5pdGlhdGUyKG5hbWUpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAobmFtZXMubGVuZ3RoID09IDApXHJcbiAgICAgICAgICAgIHRoaXMuaW5pdGlhdGUyKG5hbWUpO1xyXG4gICAgfVxyXG5cclxuICAgIGluaXRpYXRlMihuYW1lKSB7XHJcbiAgICAgICAgaWYgKCEodGhpcy5kYXRhW25hbWVdICYmICh0aGlzLmRhdGFbbmFtZV0ucGFyZW50ICYmIHRoaXMuZGF0YVt0aGlzLmRhdGFbbmFtZV0ucGFyZW50XS50YWJzY29udGVudCAmJiB0aGlzLmRhdGFbbmFtZV0uY29udGVudCAmJiB0aGlzLmRhdGFbdGhpcy5kYXRhW25hbWVdLnBhcmVudF0uaGVhZGVyKSB8fCAoIXRoaXMuZGF0YVtuYW1lXS5wYXJlbnQgJiYgdGhpcy5kYXRhW25hbWVdLmNvbnRlbnQgJiYgdGhpcy5kYXRhW25hbWVdLmhlYWRlcikpKVxyXG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgbGV0IHBhcmVudCA9IHRoaXMuZGF0YVtuYW1lXS5wYXJlbnQ7XHJcbiAgICAgICAgbGV0IGNvbnRlbnQgPSB0aGlzLmRhdGFbbmFtZV0uY29udGVudDtcclxuICAgICAgICBsZXQgY29udGVudEVsZW0gPSB0aGlzLmRhdGFbbmFtZV0uY29udGVudEVsZW07XHJcbiAgICAgICAgaWYgKHRoaXMuZGF0YVtuYW1lXS5zY3JvbGxUb3AgPT0gbnVsbClcclxuICAgICAgICAgICAgdGhpcy5kYXRhW25hbWVdLnNjcm9sbFRvcCA9IDA7XHJcbiAgICAgICAgaWYgKHRoaXMuZGF0YVtuYW1lXS5sYXN0c2Nyb2xsID09IG51bGwpXHJcbiAgICAgICAgICAgIHRoaXMuZGF0YVtuYW1lXS5sYXN0c2Nyb2xsID0gMDtcclxuICAgICAgICBpZiAodGhpcy5kYXRhW25hbWVdLmRpcmVjdGlvbiA9PSBudWxsKVxyXG4gICAgICAgICAgICB0aGlzLmRhdGFbbmFtZV0uZGlyZWN0aW9uID0gJyc7XHJcbiAgICAgICAgaWYgKHRoaXMuZGF0YVtuYW1lXS50YXBwaW5nID09IG51bGwpXHJcbiAgICAgICAgICAgIHRoaXMuZGF0YVtuYW1lXS50YXBwaW5nID0gZmFsc2U7XHJcbiAgICAgICAgY29udGVudC5zY3JvbGxFdmVudHMgPSB0cnVlO1xyXG4gICAgICAgIGlmICghcGFyZW50KSB7XHJcbiAgICAgICAgICAgIGxldCBoZWFkZXIgPSB0aGlzLmRhdGFbbmFtZV0uaGVhZGVyO1xyXG4gICAgICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHtcclxuICAgICAgICAgICAgICAgIHRoaXMuZGF0YVtuYW1lXS5uYXZoZWlnaHQgPSB0aGlzLmRhdGFbbmFtZV0uaGVhZGVyLm5hdGl2ZUVsZW1lbnQub2Zmc2V0SGVpZ2h0O1xyXG4gICAgICAgICAgICAgICAgbGV0IHNjcm9sbENvbnRlbnQ6IGFueSA9IGNvbnRlbnRFbGVtLm5hdGl2ZUVsZW1lbnQuc2hhZG93Um9vdC5xdWVyeVNlbGVjdG9yKCcuaW5uZXItc2Nyb2xsJyk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmRhdGFbbmFtZV0ucGFkZGluZ1RvcCA9IHBhcnNlSW50KHdpbmRvdy5nZXRDb21wdXRlZFN0eWxlKHNjcm9sbENvbnRlbnQpWydwYWRkaW5nLXRvcCddLCAxMCk7XHJcbiAgICAgICAgICAgICAgICBjb250ZW50LmlvblNjcm9sbC5zdWJzY3JpYmUoKGUpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICBpZihlLmRldGFpbC5zY3JvbGxUb3AgPT0gMCl7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHNjcm9sbENvbnRlbnQuc3R5bGUudG9wID0gbnVsbDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgc2Nyb2xsQ29udGVudC5zdHlsZS5wYWRkaW5nVG9wID0gdGhpcy5kYXRhW25hbWVdLnBhZGRpbmdUb3AgKyAncHgnO1xyXG4gICAgICAgICAgICAgICAgICAgIH1lbHNle1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBzY3JvbGxDb250ZW50LnN0eWxlLnRvcCA9ICctJyArIHRoaXMuZGF0YVtuYW1lXS5uYXZoZWlnaHQgKyAncHgnO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBzY3JvbGxDb250ZW50LnN0eWxlLnBhZGRpbmdUb3AgPSB0aGlzLmRhdGFbbmFtZV0ucGFkZGluZ1RvcCArIHRoaXMuZGF0YVtuYW1lXS5uYXZoZWlnaHQgKyAncHgnO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBpZiAoc2Nyb2xsQ29udGVudC5zY3JvbGxIZWlnaHQgPiAoc2Nyb2xsQ29udGVudC5jbGllbnRIZWlnaHQgKyAxMDApKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZGF0YVtuYW1lXS5zY3JvbGxpbmcgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBsZXQgeCA9IHRoaXMuZGF0YVtuYW1lXS5sYXN0c2Nyb2xsIC0gZS5kZXRhaWwuc2Nyb2xsVG9wO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmRhdGFbbmFtZV0uZGlyZWN0aW9uID0geCA+IDAgPyAndXAnIDogJ2Rvd24nO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmRhdGFbbmFtZV0ubGFzdHNjcm9sbCA9IGUuZGV0YWlsLnNjcm9sbFRvcDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5kYXRhW25hbWVdLnNjcm9sbFRvcCA9IHRoaXMuZGF0YVtuYW1lXS5zY3JvbGxUb3AgLSB4O1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5kYXRhW25hbWVdLnNjcm9sbFRvcCA+IHRoaXMuZGF0YVtuYW1lXS5uYXZoZWlnaHQpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmRhdGFbbmFtZV0uc2Nyb2xsVG9wID0gdGhpcy5kYXRhW25hbWVdLm5hdmhlaWdodDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuZGF0YVtuYW1lXS5zY3JvbGxUb3AgPCAwKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5kYXRhW25hbWVdLnNjcm9sbFRvcCA9IDA7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGhlYWRlci5uYXRpdmVFbGVtZW50LnN0eWxlLnRyYW5zZm9ybSA9ICd0cmFuc2xhdGUzZCgwLCAnICsgLXRoaXMuZGF0YVtuYW1lXS5zY3JvbGxUb3AgKyAncHgsIDApJztcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIGNvbnRlbnQuaW9uU2Nyb2xsRW5kLnN1YnNjcmliZSgoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vY2F0Y2ggdGhlIGxhc3QgdGlja1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoc2Nyb2xsQ29udGVudC5zY3JvbGxUb3AgPT0gMCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc2Nyb2xsQ29udGVudC5zdHlsZS50b3AgPSBudWxsO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc2Nyb2xsQ29udGVudC5zdHlsZS5wYWRkaW5nVG9wID0gdGhpcy5kYXRhW25hbWVdLnBhZGRpbmdUb3AgKyAncHgnO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZGF0YVtuYW1lXS5zY3JvbGxpbmcgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5jKG5hbWUpO1xyXG4gICAgICAgICAgICAgICAgICAgIH0sIDEwKVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH0sIDEwMCk7XHJcbiAgICAgICAgICAgIGNvbnRlbnRFbGVtLm5hdGl2ZUVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcigndG91Y2hlbmQnLCAoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmRhdGFbbmFtZV0udGFwcGluZyA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5jKG5hbWUpO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgY29udGVudEVsZW0ubmF0aXZlRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKCd0b3VjaHN0YXJ0JywgKCkgPT4gdGhpcy5kYXRhW25hbWVdLnRhcHBpbmcgPSB0cnVlKTtcclxuICAgICAgICB9IGVsc2UgaWYgKHBhcmVudCkge1xyXG4gICAgICAgICAgICBsZXQgaGVhZGVyID0gdGhpcy5kYXRhW3BhcmVudF0uaGVhZGVyO1xyXG4gICAgICAgICAgICBsZXQgdGFic2NvbnRlbnRFbGVtID0gdGhpcy5kYXRhW3BhcmVudF0udGFic2NvbnRlbnRFbGVtO1xyXG4gICAgICAgICAgICBsZXQgc3VwZXJ0YWJzVG9vbGJhcjogYW55ID0gdGFic2NvbnRlbnRFbGVtLm5hdGl2ZUVsZW1lbnQucXVlcnlTZWxlY3Rvcignc3VwZXItdGFicy10b29sYmFyJyk7XHJcbiAgICAgICAgICAgIHNldFRpbWVvdXQoKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5kYXRhW3BhcmVudF0udGFic2NvbnRlbnRIZWlnaHQgPSB0YWJzY29udGVudEVsZW0ubmF0aXZlRWxlbWVudC5zY3JvbGxIZWlnaHQ7XHJcbiAgICAgICAgICAgICAgICBsZXQgc2Nyb2xsQ29udGVudDogYW55ID0gY29udGVudEVsZW0ubmF0aXZlRWxlbWVudC5zaGFkb3dSb290LnF1ZXJ5U2VsZWN0b3IoJy5pbm5lci1zY3JvbGwnKTtcclxuICAgICAgICAgICAgICAgIGxldCB0YWJzc2Nyb2xsQ29udGVudDogYW55ID0gdGhpcy5kYXRhW3BhcmVudF0udGFic2NvbnRlbnRFbGVtLm5hdGl2ZUVsZW1lbnQuc2hhZG93Um9vdC5xdWVyeVNlbGVjdG9yKCcuaW5uZXItc2Nyb2xsJyk7XHJcbiAgICAgICAgICAgICAgICBpZiAoc2Nyb2xsQ29udGVudC5zY3JvbGxIZWlnaHQgPiAoc2Nyb2xsQ29udGVudC5jbGllbnRIZWlnaHQgKyAxMDApKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5kYXRhW25hbWVdLm5hdmhlaWdodCA9IHRoaXMuZGF0YVtwYXJlbnRdLmhlYWRlci5uYXRpdmVFbGVtZW50Lm9mZnNldEhlaWdodDtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmRhdGFbbmFtZV0ucGFkZGluZ1RvcCA9IHBhcnNlSW50KHdpbmRvdy5nZXRDb21wdXRlZFN0eWxlKHNjcm9sbENvbnRlbnQpWydwYWRkaW5nLXRvcCddLCAxMCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBjb250ZW50LmlvblNjcm9sbC5zdWJzY3JpYmUoKGUpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5kYXRhW25hbWVdLnRhcHBpbmcgJiYgc2Nyb2xsQ29udGVudC5zY3JvbGxIZWlnaHQgPiAoc2Nyb2xsQ29udGVudC5jbGllbnRIZWlnaHQgKyAxMDApKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChlLmRldGFpbC5zY3JvbGxUb3AgPT0gMCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc3VwZXJ0YWJzVG9vbGJhci5zdHlsZS5wb3NpdGlvbiA9ICdzdGF0aWMnO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc2Nyb2xsQ29udGVudC5zdHlsZS5wYWRkaW5nVG9wID0gdGhpcy5kYXRhW25hbWVdLnBhZGRpbmdUb3AgKyAncHgnO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGFic2NvbnRlbnRFbGVtLm5hdGl2ZUVsZW1lbnQuc3R5bGUudG9wID0gbnVsbDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRhYnNzY3JvbGxDb250ZW50LnN0eWxlLmhlaWdodCA9IHRoaXMuZGF0YVtwYXJlbnRdLnRhYnNjb250ZW50SGVpZ2h0ICsgJ3B4JztcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRhYnNjb250ZW50RWxlbS5uYXRpdmVFbGVtZW50LnN0eWxlLnRvcCA9IG51bGw7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZXQgcyA9IGUuZGV0YWlsLnNjcm9sbFRvcDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN1cGVydGFic1Rvb2xiYXIuc3R5bGUucG9zaXRpb24gPSAnYWJzb2x1dGUnO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc3VwZXJ0YWJzVG9vbGJhci5zdHlsZS50b3AgPSB0aGlzLmRhdGFbbmFtZV0ubmF2aGVpZ2h0ICsgJ3B4JztcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRhYnNzY3JvbGxDb250ZW50LnN0eWxlLmhlaWdodCA9ICh0aGlzLmRhdGFbcGFyZW50XS50YWJzY29udGVudEhlaWdodCArIHRoaXMuZGF0YVtuYW1lXS5uYXZoZWlnaHQpICsgJ3B4JztcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRhYnNjb250ZW50RWxlbS5uYXRpdmVFbGVtZW50LnN0eWxlLnRvcCA9ICctJyArIHRoaXMuZGF0YVtuYW1lXS5uYXZoZWlnaHQgKyAncHgnO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc2Nyb2xsQ29udGVudC5zdHlsZS5wYWRkaW5nVG9wID0gdGhpcy5kYXRhW25hbWVdLnBhZGRpbmdUb3AgKyBzdXBlcnRhYnNUb29sYmFyLmNsaWVudEhlaWdodCArIHRoaXMuZGF0YVtuYW1lXS5uYXZoZWlnaHQgKyAncHgnO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc2Nyb2xsQ29udGVudC5zY3JvbGxUb3AgPSBzO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZGF0YVtuYW1lXS5zY3JvbGxpbmcgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgICAgIGxldCB4ID0gdGhpcy5kYXRhW25hbWVdLmxhc3RzY3JvbGwgLSBlLmRldGFpbC5zY3JvbGxUb3A7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5kYXRhW25hbWVdLmRpcmVjdGlvbiA9IHggPiAwID8gJ3VwJyA6ICdkb3duJztcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmRhdGFbbmFtZV0ubGFzdHNjcm9sbCA9IGUuZGV0YWlsLnNjcm9sbFRvcDtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmRhdGFbbmFtZV0uc2Nyb2xsVG9wID0gdGhpcy5kYXRhW25hbWVdLnNjcm9sbFRvcCAtIHg7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuZGF0YVtuYW1lXS5zY3JvbGxUb3AgPiB0aGlzLmRhdGFbbmFtZV0ubmF2aGVpZ2h0KVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmRhdGFbbmFtZV0uc2Nyb2xsVG9wID0gdGhpcy5kYXRhW25hbWVdLm5hdmhlaWdodDtcclxuICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5kYXRhW25hbWVdLnNjcm9sbFRvcCA8IDApXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZGF0YVtuYW1lXS5zY3JvbGxUb3AgPSAwO1xyXG4gICAgICAgICAgICAgICAgICAgIGhlYWRlci5uYXRpdmVFbGVtZW50LnN0eWxlLnRyYW5zZm9ybSA9ICd0cmFuc2xhdGUzZCgwLCAnICsgLXRoaXMuZGF0YVtuYW1lXS5zY3JvbGxUb3AgKyAncHgsIDApJztcclxuICAgICAgICAgICAgICAgICAgICBzdXBlcnRhYnNUb29sYmFyLnN0eWxlLnRyYW5zZm9ybSA9ICd0cmFuc2xhdGUzZCgwLCAnICsgLXRoaXMuZGF0YVtuYW1lXS5zY3JvbGxUb3AgKyAncHgsIDApJztcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgY29udGVudC5pb25TY3JvbGxFbmQuc3Vic2NyaWJlKCgpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgLy9jYXRjaCB0aGUgbGFzdCB0aWNrXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChzY3JvbGxDb250ZW50LnNjcm9sbFRvcCA9PSAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdXBlcnRhYnNUb29sYmFyLnN0eWxlLnBvc2l0aW9uID0gJ3N0YXRpYyc7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzY3JvbGxDb250ZW50LnN0eWxlLnBhZGRpbmdUb3AgPSB0aGlzLmRhdGFbbmFtZV0ucGFkZGluZ1RvcCArICdweCc7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0YWJzY29udGVudEVsZW0ubmF0aXZlRWxlbWVudC5zdHlsZS50b3AgPSBudWxsO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGFic3Njcm9sbENvbnRlbnQuc3R5bGUuaGVpZ2h0ID0gdGhpcy5kYXRhW3BhcmVudF0udGFic2NvbnRlbnRIZWlnaHQgKyAncHgnO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGFic2NvbnRlbnRFbGVtLm5hdGl2ZUVsZW1lbnQuc3R5bGUudG9wID0gbnVsbDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmRhdGFbbmFtZV0uc2Nyb2xsaW5nID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuYyhuYW1lKTtcclxuICAgICAgICAgICAgICAgICAgICB9LCAxMClcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9LCAxMDApO1xyXG4gICAgICAgICAgICBjb250ZW50RWxlbS5uYXRpdmVFbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ3RvdWNoZW5kJywgKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5kYXRhW25hbWVdLnRhcHBpbmcgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgIHRoaXMuYyhuYW1lKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIGNvbnRlbnRFbGVtLm5hdGl2ZUVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcigndG91Y2hzdGFydCcsICgpID0+IHRoaXMuZGF0YVtuYW1lXS50YXBwaW5nID0gdHJ1ZSk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIHByaXZhdGUgYyhuYW1lKSB7XHJcbiAgICAgICAgaWYgKHRoaXMuZGF0YVtuYW1lXS50YXBwaW5nIHx8IHRoaXMuZGF0YVtuYW1lXS5zY3JvbGxpbmcpXHJcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICBpZiAodGhpcy5kYXRhW25hbWVdLnNjcm9sbFRvcCA9PSAwIHx8IHRoaXMuZGF0YVtuYW1lXS5zY3JvbGxUb3AgPT0gdGhpcy5kYXRhW25hbWVdLm5hdmhlaWdodClcclxuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgIGxldCBjb250ZW50ID0gdGhpcy5kYXRhW25hbWVdLmNvbnRlbnQ7XHJcbiAgICAgICAgbGV0IHNjcm9sbFRvcFRlbXAgPSB0aGlzLmRhdGFbbmFtZV0uc2Nyb2xsVG9wO1xyXG4gICAgICAgIGlmICh0aGlzLmRhdGFbbmFtZV0uZGlyZWN0aW9uID09ICdkb3duJykge1xyXG4gICAgICAgICAgICBpZiAodGhpcy5kYXRhW25hbWVdLnNjcm9sbFRvcCA8IHRoaXMuZGF0YVtuYW1lXS5uYXZoZWlnaHQpIHtcclxuICAgICAgICAgICAgICAgIGNvbnRlbnQuc2Nyb2xsQnlQb2ludCgwLCAodGhpcy5kYXRhW25hbWVdLm5hdmhlaWdodCAtIHNjcm9sbFRvcFRlbXApLCAodGhpcy5kYXRhW25hbWVdLm5hdmhlaWdodCAtIHNjcm9sbFRvcFRlbXApICogNik7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9IGVsc2UgaWYgKHRoaXMuZGF0YVtuYW1lXS5kaXJlY3Rpb24gPT0gJ3VwJykge1xyXG4gICAgICAgICAgICBpZiAodGhpcy5kYXRhW25hbWVdLnNjcm9sbFRvcCA8IHRoaXMuZGF0YVtuYW1lXS5uYXZoZWlnaHQpIHtcclxuICAgICAgICAgICAgICAgIGNvbnRlbnQuc2Nyb2xsQnlQb2ludCgwLCAtc2Nyb2xsVG9wVGVtcCwgc2Nyb2xsVG9wVGVtcCAqIDYpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIHJlc2V0VGFicyhwYXJlbnQsIG5hbWUpIHtcclxuICAgICAgICBsZXQgaGVhZGVyID0gdGhpcy5kYXRhW3BhcmVudF0uaGVhZGVyO1xyXG4gICAgICAgIGxldCB0YWJzY29udGVudEVsZW0gPSB0aGlzLmRhdGFbcGFyZW50XS50YWJzY29udGVudEVsZW07XHJcbiAgICAgICAgbGV0IHN1cGVydGFic1Rvb2xiYXI6IGFueSA9IHRhYnNjb250ZW50RWxlbS5uYXRpdmVFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJ3N1cGVyLXRhYnMtdG9vbGJhcicpO1xyXG4gICAgICAgIGxldCB0YWJzc2Nyb2xsQ29udGVudDogYW55ID0gdGhpcy5kYXRhW3BhcmVudF0udGFic2NvbnRlbnRFbGVtLm5hdGl2ZUVsZW1lbnQuc2hhZG93Um9vdC5xdWVyeVNlbGVjdG9yKCcuaW5uZXItc2Nyb2xsJyk7XHJcbiAgICAgICAgbGV0IHNjcm9sbENvbnRlbnQ6IGFueSA9IHRoaXMuZGF0YVtuYW1lXS5jb250ZW50RWxlbS5uYXRpdmVFbGVtZW50LnNoYWRvd1Jvb3QucXVlcnlTZWxlY3RvcignLmlubmVyLXNjcm9sbCcpO1xyXG4gICAgICAgIHNjcm9sbENvbnRlbnQuc2Nyb2xsVG9wID0gc2Nyb2xsQ29udGVudC5zY3JvbGxUb3AgLSB0aGlzLmRhdGFbbmFtZV0uc2Nyb2xsVG9wO1xyXG4gICAgICAgIHNldFRpbWVvdXQoKCkgPT4ge1xyXG4gICAgICAgICAgICBpZiAoc2Nyb2xsQ29udGVudC5zY3JvbGxUb3AgPT0gMCkge1xyXG4gICAgICAgICAgICAgICAgc3VwZXJ0YWJzVG9vbGJhci5zdHlsZS5wb3NpdGlvbiA9ICdzdGF0aWMnO1xyXG4gICAgICAgICAgICAgICAgc2Nyb2xsQ29udGVudC5zdHlsZS5wYWRkaW5nVG9wID0gdGhpcy5kYXRhW25hbWVdLnBhZGRpbmdUb3AgKyAncHgnO1xyXG4gICAgICAgICAgICAgICAgdGFic2NvbnRlbnRFbGVtLm5hdGl2ZUVsZW1lbnQuc3R5bGUudG9wID0gbnVsbDtcclxuICAgICAgICAgICAgICAgIHRhYnNzY3JvbGxDb250ZW50LnN0eWxlLmhlaWdodCA9IHRoaXMuZGF0YVtwYXJlbnRdLnRhYnNjb250ZW50SGVpZ2h0ICsgJ3B4JztcclxuICAgICAgICAgICAgICAgIHRhYnNjb250ZW50RWxlbS5uYXRpdmVFbGVtZW50LnN0eWxlLnRvcCA9IG51bGw7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBsZXQgcyA9IHNjcm9sbENvbnRlbnQuc2Nyb2xsVG9wO1xyXG4gICAgICAgICAgICAgICAgc3VwZXJ0YWJzVG9vbGJhci5zdHlsZS5wb3NpdGlvbiA9ICdhYnNvbHV0ZSc7XHJcbiAgICAgICAgICAgICAgICBzdXBlcnRhYnNUb29sYmFyLnN0eWxlLnRvcCA9IHRoaXMuZGF0YVtuYW1lXS5uYXZoZWlnaHQgKyAncHgnO1xyXG4gICAgICAgICAgICAgICAgdGFic3Njcm9sbENvbnRlbnQuc3R5bGUuaGVpZ2h0ID0gKHRoaXMuZGF0YVtwYXJlbnRdLnRhYnNjb250ZW50SGVpZ2h0ICsgdGhpcy5kYXRhW25hbWVdLm5hdmhlaWdodCkgKyAncHgnO1xyXG4gICAgICAgICAgICAgICAgdGFic2NvbnRlbnRFbGVtLm5hdGl2ZUVsZW1lbnQuc3R5bGUudG9wID0gJy0nICsgdGhpcy5kYXRhW25hbWVdLm5hdmhlaWdodCArICdweCc7XHJcbiAgICAgICAgICAgICAgICBzY3JvbGxDb250ZW50LnN0eWxlLnBhZGRpbmdUb3AgPSB0aGlzLmRhdGFbbmFtZV0ucGFkZGluZ1RvcCArIHN1cGVydGFic1Rvb2xiYXIuY2xpZW50SGVpZ2h0ICsgdGhpcy5kYXRhW25hbWVdLm5hdmhlaWdodCArICdweCc7XHJcbiAgICAgICAgICAgICAgICBzY3JvbGxDb250ZW50LnNjcm9sbFRvcCA9IHM7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaGVhZGVyLm5hdGl2ZUVsZW1lbnQuc3R5bGUudHJhbnNmb3JtID0gbnVsbDtcclxuICAgICAgICAgICAgc3VwZXJ0YWJzVG9vbGJhci5zdHlsZS50cmFuc2Zvcm0gPSBudWxsO1xyXG4gICAgICAgIH0sIDIwKTtcclxuXHJcbiAgICB9XHJcbn1cclxuIl19