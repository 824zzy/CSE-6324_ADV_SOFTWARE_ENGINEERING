/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import { Component, ContentChild, ElementRef, Input, EventEmitter, Output, ContentChildren, HostBinding } from '@angular/core';
import { HidenavShService } from './hidenav-sh-service.service';
var HidenavStretchheaderComponent = /** @class */ (function () {
    function HidenavStretchheaderComponent(el, globals) {
        this.el = el;
        this.globals = globals;
        this.scroll = new EventEmitter();
    }
    /**
     * @return {?}
     */
    HidenavStretchheaderComponent.prototype.ngOnInit = /**
     * @return {?}
     */
    function () {
    };
    /**
     * @return {?}
     */
    HidenavStretchheaderComponent.prototype.ngAfterViewInit = /**
     * @return {?}
     */
    function () {
        var _this = this;
        /** @type {?} */
        var observer = new MutationObserver((/**
         * @param {?} mutations
         * @return {?}
         */
        function (mutations) {
            mutations.forEach((/**
             * @return {?}
             */
            function () {
                if (_this.el.nativeElement.getAttribute('hidenav-sh-header').length > 0) {
                    _this.name = _this.el.nativeElement.getAttribute('hidenav-sh-header');
                    _this.start();
                    observer.disconnect();
                }
            }));
        }));
        observer.observe(this.el.nativeElement, {
            attributes: true,
        });
    };
    /**
     * @return {?}
     */
    HidenavStretchheaderComponent.prototype.start = /**
     * @return {?}
     */
    function () {
        var _this = this;
        if (this.name) {
            if (typeof this.globals.data[this.name] == 'undefined' || this.globals.data[this.name] == null)
                this.globals.data[this.name] = [];
            this.globals.data[this.name].header = this.header;
            this.globals.data[this.name].static = this.static;
            this.globals.initiate(this.name);
            this.globals.scroll.subscribe((/**
             * @param {?} res
             * @return {?}
             */
            function (res) {
                if (res.name == _this.name) {
                    _this.scroll.emit(res.height);
                }
            }));
            if (this.noBorder != 'true') {
                /** @type {?} */
                var mode_1 = document.querySelector('html').getAttribute('mode');
                setTimeout((/**
                 * @return {?}
                 */
                function () {
                    if (typeof _this.class == 'undefined') {
                        _this.class = mode_1;
                    }
                    else {
                        _this.class += ' ' + mode_1;
                    }
                }), 0);
            }
        }
    };
    /**
     * @param {?=} duration
     * @return {?}
     */
    HidenavStretchheaderComponent.prototype.expand = /**
     * @param {?=} duration
     * @return {?}
     */
    function (duration) {
        if (duration === void 0) { duration = 200; }
        this.globals.expand(this.name, duration);
    };
    /**
     * @param {?=} duration
     * @return {?}
     */
    HidenavStretchheaderComponent.prototype.shrink = /**
     * @param {?=} duration
     * @return {?}
     */
    function (duration) {
        if (duration === void 0) { duration = 200; }
        this.globals.shrink(this.name, duration);
    };
    /**
     * @param {?=} duration
     * @return {?}
     */
    HidenavStretchheaderComponent.prototype.toggle = /**
     * @param {?=} duration
     * @return {?}
     */
    function (duration) {
        if (duration === void 0) { duration = 200; }
        this.globals.toggle(this.name, duration);
    };
    /**
     * @return {?}
     */
    HidenavStretchheaderComponent.prototype.ngOnDestroy = /**
     * @return {?}
     */
    function () {
        if (this.name) {
            delete this.globals.data[this.name].header;
        }
    };
    HidenavStretchheaderComponent.decorators = [
        { type: Component, args: [{
                    selector: 'hidenav-stretchheader',
                    template: "\n        <style>\n            .overlay {\n                position: absolute;\n                height: inherit;\n                width: inherit;\n                z-index: 101;\n                pointer-events: none;\n                /*opacity: var(--opacity);*/\n                background: var(--color);\n                filter: opacity(0);\n                --opacity: 0;\n                --color: black;\n            }\n\n            :host {\n                --blur: 0;\n                z-index: 1;\n            }\n\n            :host.md {\n                -webkit-box-shadow: 0px 2px 5px 0px rgba(0, 0, 0, 0.53);\n                -moz-box-shadow: 0px 2px 5px 0px rgba(0, 0, 0, 0.53);\n                box-shadow: 0px 2px 5px 0px rgba(0, 0, 0, 0.53);\n            }\n\n            :host.ios {\n                border-bottom: 1px solid #5a5e63;\n            }\n        </style>\n        <div class=\"overlay\"></div>\n        <ng-content></ng-content>\n    "
                }] }
    ];
    HidenavStretchheaderComponent.ctorParameters = function () { return [
        { type: ElementRef },
        { type: HidenavShService }
    ]; };
    HidenavStretchheaderComponent.propDecorators = {
        header: [{ type: ContentChild, args: ['shrinkexpand', { read: ElementRef },] }],
        static: [{ type: ContentChildren, args: ['static', { read: ElementRef },] }],
        class: [{ type: HostBinding, args: ['class',] }],
        noBorder: [{ type: Input, args: ['no-border',] }],
        headerHeight: [{ type: Input, args: ['header-height',] }],
        initExpanded: [{ type: Input, args: ['init-expanded',] }],
        opacityColor: [{ type: Input, args: ['opacity-color',] }],
        opacityFactor: [{ type: Input, args: ['opacity-factor',] }],
        blurFactor: [{ type: Input, args: ['blur-factor',] }],
        preserveHeader: [{ type: Input, args: ['preserve-header',] }],
        scroll: [{ type: Output }]
    };
    return HidenavStretchheaderComponent;
}());
export { HidenavStretchheaderComponent };
if (false) {
    /** @type {?} */
    HidenavStretchheaderComponent.prototype.header;
    /** @type {?} */
    HidenavStretchheaderComponent.prototype.static;
    /** @type {?} */
    HidenavStretchheaderComponent.prototype.class;
    /** @type {?} */
    HidenavStretchheaderComponent.prototype.name;
    /** @type {?} */
    HidenavStretchheaderComponent.prototype.noBorder;
    /** @type {?} */
    HidenavStretchheaderComponent.prototype.headerHeight;
    /** @type {?} */
    HidenavStretchheaderComponent.prototype.initExpanded;
    /** @type {?} */
    HidenavStretchheaderComponent.prototype.opacityColor;
    /** @type {?} */
    HidenavStretchheaderComponent.prototype.opacityFactor;
    /** @type {?} */
    HidenavStretchheaderComponent.prototype.blurFactor;
    /** @type {?} */
    HidenavStretchheaderComponent.prototype.preserveHeader;
    /** @type {?} */
    HidenavStretchheaderComponent.prototype.scroll;
    /** @type {?} */
    HidenavStretchheaderComponent.prototype.el;
    /** @type {?} */
    HidenavStretchheaderComponent.prototype.globals;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaGlkZW5hdi1zdHJldGNoaGVhZGVyLmNvbXBvbmVudC5qcyIsInNvdXJjZVJvb3QiOiJuZzovL2lvbmljNC1oaWRlbmF2LyIsInNvdXJjZXMiOlsibGliL2hpZGVuYXYtc3RyZXRjaGhlYWRlci5jb21wb25lbnQudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7OztBQUFBLE9BQU8sRUFFSCxTQUFTLEVBQ1QsWUFBWSxFQUNaLFVBQVUsRUFFVixLQUFLLEVBQ0wsWUFBWSxFQUNaLE1BQU0sRUFDTixlQUFlLEVBQ2YsV0FBVyxFQUNkLE1BQU0sZUFBZSxDQUFDO0FBQ3ZCLE9BQU8sRUFBQyxnQkFBZ0IsRUFBQyxNQUFNLDhCQUE4QixDQUFDO0FBRTlEO0lBbURJLHVDQUFtQixFQUFjLEVBQVMsT0FBeUI7UUFBaEQsT0FBRSxHQUFGLEVBQUUsQ0FBWTtRQUFTLFlBQU8sR0FBUCxPQUFPLENBQWtCO1FBRnpELFdBQU0sR0FBeUIsSUFBSSxZQUFZLEVBQVUsQ0FBQztJQUdwRSxDQUFDOzs7O0lBRUQsZ0RBQVE7OztJQUFSO0lBQ0EsQ0FBQzs7OztJQUVELHVEQUFlOzs7SUFBZjtRQUFBLGlCQWFDOztZQVpTLFFBQVEsR0FBRyxJQUFJLGdCQUFnQjs7OztRQUFDLFVBQUMsU0FBUztZQUM1QyxTQUFTLENBQUMsT0FBTzs7O1lBQUM7Z0JBQ2QsSUFBRyxLQUFJLENBQUMsRUFBRSxDQUFDLGFBQWEsQ0FBQyxZQUFZLENBQUMsbUJBQW1CLENBQUMsQ0FBQyxNQUFNLEdBQUcsQ0FBQyxFQUFFO29CQUNuRSxLQUFJLENBQUMsSUFBSSxHQUFHLEtBQUksQ0FBQyxFQUFFLENBQUMsYUFBYSxDQUFDLFlBQVksQ0FBQyxtQkFBbUIsQ0FBQyxDQUFDO29CQUNwRSxLQUFJLENBQUMsS0FBSyxFQUFFLENBQUM7b0JBQ2IsUUFBUSxDQUFDLFVBQVUsRUFBRSxDQUFDO2lCQUN6QjtZQUNMLENBQUMsRUFBQyxDQUFDO1FBQ1AsQ0FBQyxFQUFDO1FBQ0YsUUFBUSxDQUFDLE9BQU8sQ0FB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Y0FBYyxFQUFFLEVBQUMsSUFBSSxFQUFFLFVBQVUsRUFBQzt5QkFDL0MsZUFBZSxTQUFDLFFBQVEsRUFBRSxFQUFDLElBQUksRUFBRSxVQUFVLEVBQUM7d0JBQzVDLFdBQVcsU0FBQyxPQUFPOzJCQUVuQixLQUFLLFNBQUMsV0FBVzsrQkFDakIsS0FBSyxTQUFDLGVBQWU7K0JBQ3JCLEtBQUssU0FBQyxlQUFlOytCQUNyQixLQUFLLFNBQUMsZUFBZTtnQ0FDckIsS0FBSyxTQUFDLGdCQUFnQjs2QkFDdEIsS0FBSyxTQUFDLGFBQWE7aUNBQ25CLEtBQUssU0FBQyxpQkFBaUI7eUJBRXZCLE1BQU07O0lBa0VYLG9DQUFDO0NBQUEsQUFuSEQsSUFtSEM7U0EvRVksNkJBQTZCOzs7SUFDdEMsK0NBQXFFOztJQUNyRSwrQ0FBMkQ7O0lBQzNELDhDQUFpQzs7SUFDakMsNkNBQVU7O0lBQ1YsaURBQXFDOztJQUNyQyxxREFBMEM7O0lBQzFDLHFEQUEwQzs7SUFDMUMscURBQTBDOztJQUMxQyxzREFBNEM7O0lBQzVDLG1EQUFzQzs7SUFDdEMsdURBQThDOztJQUU5QywrQ0FBb0U7O0lBRXhELDJDQUFxQjs7SUFBRSxnREFBZ0MiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQge1xyXG4gICAgQWZ0ZXJWaWV3SW5pdCxcclxuICAgIENvbXBvbmVudCxcclxuICAgIENvbnRlbnRDaGlsZCxcclxuICAgIEVsZW1lbnRSZWYsXHJcbiAgICBPbkluaXQsXHJcbiAgICBJbnB1dCxcclxuICAgIEV2ZW50RW1pdHRlcixcclxuICAgIE91dHB1dCxcclxuICAgIENvbnRlbnRDaGlsZHJlbixcclxuICAgIEhvc3RCaW5kaW5nXHJcbn0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XHJcbmltcG9ydCB7SGlkZW5hdlNoU2VydmljZX0gZnJvbSAnLi9oaWRlbmF2LXNoLXNlcnZpY2Uuc2VydmljZSc7XHJcblxyXG5AQ29tcG9uZW50KHtcclxuICAgIHNlbGVjdG9yOiAnaGlkZW5hdi1zdHJldGNoaGVhZGVyJyxcclxuICAgIHRlbXBsYXRlOiBgXHJcbiAgICAgICAgPHN0eWxlPlxyXG4gICAgICAgICAgICAub3ZlcmxheSB7XHJcbiAgICAgICAgICAgICAgICBwb3NpdGlvbjogYWJzb2x1dGU7XHJcbiAgICAgICAgICAgICAgICBoZWlnaHQ6IGluaGVyaXQ7XHJcbiAgICAgICAgICAgICAgICB3aWR0aDogaW5oZXJpdDtcclxuICAgICAgICAgICAgICAgIHotaW5kZXg6IDEwMTtcclxuICAgICAgICAgICAgICAgIHBvaW50ZXItZXZlbnRzOiBub25lO1xyXG4gICAgICAgICAgICAgICAgLypvcGFjaXR5OiB2YXIoLS1vcGFjaXR5KTsqL1xyXG4gICAgICAgICAgICAgICAgYmFja2dyb3VuZDogdmFyKC0tY29sb3IpO1xyXG4gICAgICAgICAgICAgICAgZmlsdGVyOiBvcGFjaXR5KDApO1xyXG4gICAgICAgICAgICAgICAgLS1vcGFjaXR5OiAwO1xyXG4gICAgICAgICAgICAgICAgLS1jb2xvcjogYmxhY2s7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIDpob3N0IHtcclxuICAgICAgICAgICAgICAgIC0tYmx1cjogMDtcclxuICAgICAgICAgICAgICAgIHotaW5kZXg6IDE7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIDpob3N0Lm1kIHtcclxuICAgICAgICAgICAgICAgIC13ZWJraXQtYm94LXNoYWRvdzogMHB4IDJweCA1cHggMHB4IHJnYmEoMCwgMCwgMCwgMC41Myk7XHJcbiAgICAgICAgICAgICAgICAtbW96LWJveC1zaGFkb3c6IDBweCAycHggNXB4IDBweCByZ2JhKDAsIDAsIDAsIDAuNTMpO1xyXG4gICAgICAgICAgICAgICAgYm94LXNoYWRvdzogMHB4IDJweCA1cHggMHB4IHJnYmEoMCwgMCwgMCwgMC41Myk7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIDpob3N0LmlvcyB7XHJcbiAgICAgICAgICAgICAgICBib3JkZXItYm90dG9tOiAxcHggc29saWQgIzVhNWU2MztcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIDwvc3R5bGU+XHJcbiAgICAgICAgPGRpdiBjbGFzcz1cIm92ZXJsYXlcIj48L2Rpdj5cclxuICAgICAgICA8bmctY29udGVudD48L25nLWNvbnRlbnQ+XHJcbiAgICBgXHJcbn0pXHJcbmV4cG9ydCBjbGFzcyBIaWRlbmF2U3RyZXRjaGhlYWRlckNvbXBvbmVudCBpbXBsZW1lbnRzIE9uSW5pdCwgQWZ0ZXJWaWV3SW5pdCB7XHJcbiAgICBAQ29udGVudENoaWxkKCdzaHJpbmtleHBhbmQnLCB7cmVhZDogRWxlbWVudFJlZn0pIGhlYWRlcjogRWxlbWVudFJlZjtcclxuICAgIEBDb250ZW50Q2hpbGRyZW4oJ3N0YXRpYycsIHtyZWFkOiBFbGVtZW50UmVmfSkgc3RhdGljOiBhbnk7XHJcbiAgICBASG9zdEJpbmRpbmcoJ2NsYXNzJykgY2xhc3M6IGFueTtcclxuICAgIG5hbWU6IGFueTtcclxuICAgIEBJbnB1dCgnbm8tYm9yZGVyJykgbm9Cb3JkZXI6IHN0cmluZztcclxuICAgIEBJbnB1dCgnaGVhZGVyLWhlaWdodCcpIGhlYWRlckhlaWdodDogYW55O1xyXG4gICAgQElucHV0KCdpbml0LWV4cGFuZGVkJykgaW5pdEV4cGFuZGVkOiBhbnk7XHJcbiAgICBASW5wdXQoJ29wYWNpdHktY29sb3InKSBvcGFjaXR5Q29sb3I6IGFueTtcclxuICAgIEBJbnB1dCgnb3BhY2l0eS1mYWN0b3InKSBvcGFjaXR5RmFjdG9yOiBhbnk7XHJcbiAgICBASW5wdXQoJ2JsdXItZmFjdG9yJykgYmx1ckZhY3RvcjogYW55O1xyXG4gICAgQElucHV0KCdwcmVzZXJ2ZS1oZWFkZXInKSBwcmVzZXJ2ZUhlYWRlcjogYW55O1xyXG5cclxuICAgIEBPdXRwdXQoKSBzY3JvbGw6IEV2ZW50RW1pdHRlcjxudW1iZXI+ID0gbmV3IEV2ZW50RW1pdHRlcjxudW1iZXI+KCk7XHJcblxyXG4gICAgY29uc3RydWN0b3IocHVibGljIGVsOiBFbGVtZW50UmVmLCBwdWJsaWMgZ2xvYmFsczogSGlkZW5hdlNoU2VydmljZSkge1xyXG4gICAgfVxyXG5cclxuICAgIG5nT25Jbml0KCkge1xyXG4gICAgfVxyXG5cclxuICAgIG5nQWZ0ZXJWaWV3SW5pdCgpIHtcclxuICAgICAgICBjb25zdCBvYnNlcnZlciA9IG5ldyBNdXRhdGlvbk9ic2VydmVyKChtdXRhdGlvbnMpID0+IHtcclxuICAgICAgICAgICAgbXV0YXRpb25zLmZvckVhY2goKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgaWYodGhpcy5lbC5uYXRpdmVFbGVtZW50LmdldEF0dHJpYnV0ZSgnaGlkZW5hdi1zaC1oZWFkZXInKS5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5uYW1lID0gdGhpcy5lbC5uYXRpdmVFbGVtZW50LmdldEF0dHJpYnV0ZSgnaGlkZW5hdi1zaC1oZWFkZXInKTtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLnN0YXJ0KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgb2JzZXJ2ZXIuZGlzY29ubmVjdCgpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9KTtcclxuICAgICAgICBvYnNlcnZlci5vYnNlcnZlKHRoaXMuZWwubmF0aXZlRWxlbWVudCwge1xyXG4gICAgICAgICAgICBhdHRyaWJ1dGVzOiB0cnVlLFxyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG5cclxuICAgIHN0YXJ0KCkge1xyXG4gICAgICAgIGlmKHRoaXMubmFtZSkge1xyXG4gICAgICAgICAgICBpZiAodHlwZW9mIHRoaXMuZ2xvYmFscy5kYXRhW3RoaXMubmFtZV0gPT0gJ3VuZGVmaW5lZCcgfHwgdGhpcy5nbG9iYWxzLmRhdGFbdGhpcy5uYW1lXSA9PSBudWxsKVxyXG4gICAgICAgICAgICAgICAgdGhpcy5nbG9iYWxzLmRhdGFbdGhpcy5uYW1lXSA9IFtdO1xyXG4gICAgICAgICAgICB0aGlzLmdsb2JhbHMuZGF0YVt0aGlzLm5hbWVdLmhlYWRlciA9IHRoaXMuaGVhZGVyO1xyXG4gICAgICAgICAgICB0aGlzLmdsb2JhbHMuZGF0YVt0aGlzLm5hbWVdLnN0YXRpYyA9IHRoaXMuc3RhdGljO1xyXG4gICAgICAgICAgICB0aGlzLmdsb2JhbHMuaW5pdGlhdGUodGhpcy5uYW1lKTtcclxuICAgICAgICAgICAgdGhpcy5nbG9iYWxzLnNjcm9sbC5zdWJzY3JpYmUocmVzID0+IHtcclxuICAgICAgICAgICAgICAgIGlmIChyZXMubmFtZSA9PSB0aGlzLm5hbWUpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLnNjcm9sbC5lbWl0KHJlcy5oZWlnaHQpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgaWYgKHRoaXMubm9Cb3JkZXIgIT0gJ3RydWUnKSB7XHJcbiAgICAgICAgICAgICAgICBsZXQgbW9kZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJ2h0bWwnKS5nZXRBdHRyaWJ1dGUoJ21vZGUnKTtcclxuICAgICAgICAgICAgICAgIHNldFRpbWVvdXQoKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICh0eXBlb2YgdGhpcy5jbGFzcyA9PSAndW5kZWZpbmVkJykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmNsYXNzID0gbW9kZTtcclxuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmNsYXNzICs9ICcgJyArIG1vZGU7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSwgMCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgZXhwYW5kKGR1cmF0aW9uID0gMjAwKSB7XHJcbiAgICAgICAgdGhpcy5nbG9iYWxzLmV4cGFuZCh0aGlzLm5hbWUsIGR1cmF0aW9uKTtcclxuICAgIH1cclxuXHJcbiAgICBzaHJpbmsoZHVyYXRpb24gPSAyMDApIHtcclxuICAgICAgICB0aGlzLmdsb2JhbHMuc2hyaW5rKHRoaXMubmFtZSwgZHVyYXRpb24pO1xyXG4gICAgfVxyXG5cclxuICAgIHRvZ2dsZShkdXJhdGlvbiA9IDIwMCkge1xyXG4gICAgICAgIHRoaXMuZ2xvYmFscy50b2dnbGUodGhpcy5uYW1lLCBkdXJhdGlvbik7XHJcbiAgICB9XHJcblxyXG4gICAgbmdPbkRlc3Ryb3koKSB7XHJcbiAgICAgICAgaWYodGhpcy5uYW1lKSB7XHJcbiAgICAgICAgICAgIGRlbGV0ZSB0aGlzLmdsb2JhbHMuZGF0YVt0aGlzLm5hbWVdLmhlYWRlcjtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG59XHJcbiJdfQ==